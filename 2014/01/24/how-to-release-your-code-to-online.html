<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>代码发布流程的一些探讨 - Hankewins Blog</title>
    <!-- meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Jekyll" />
    <meta name="author" content="Hankewins" />
    <meta name="description" content="Hankewins Blog" />
    <meta name="keywords" content="" />
    <!-- atom -->
    <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="http://hankewins.com/atom.xml" />
    <link rel="shortcut icon" href="/fa.png" type="image/x-icon" />
    <!-- font-awesome -->
    <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Spirax' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="http://hankewins.com/css/syntax.css">
    <link rel="stylesheet" href="http://hankewins.com/css/main.css">
    
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-43923900-1']);
        _gaq.push(['_trackPageview']);
        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
              ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(ga, s);
        })();
    </script>
    
</head>
<body>
    <div class="head fn-clear">
        <div class="header">
            <h1 class="logo">
                <a href="http://hankewins.com"><i class="icon-anchor"></i></a>
            </h1>
            <nav class="nav">
                <ul>
                    
                    
                    
                    <li class="nav-item ">
                        <a href="http://hankewins.com/index.html">
                            首页
                        </a>
                        
                    </li>
                    
                    
                    
                    <li class="nav-item ">
                        <a href="http://hankewins.com/categories.html">
                            分类目录
                        </a>
                        
                    </li>
                    
                    
                    
                    <li class="nav-item ">
                        <a href="http://hankewins.com/archives.html">
                            文章归档
                        </a>
                        
                    </li>
                    
                    
                    
                    <li class="nav-item ">
                        <a href="http://hankewins.com/about.html">
                            关于我
                        </a>
                        
                    </li>
                    
                    
                    
                    <li class="nav-item ">
                        <a href="http://hankewins.com/links.html">
                            友情链接
                        </a>
                        
                    </li>
                    
                </ul>
            </nav>
            <div class="follow">
                
                <a href="/atom.xml" target="_blank"><i class="icon-rss"></i></a>
                
                <a href="http://weibo.com/hankewins" target="_blank"><i class="icon-weibo"></i></a>
                
                <a href="http://renren.com/yh726927378" target="_blank"><i class="icon-renren"></i></a>
                
                <a href="http://github.com/hankewins" target="_blank"><i class="icon-github-alt"></i></a>
                
                <a href="http://twitter.com/hankewins" target="_blank"><i class="icon-twitter"></i></a>
                
                <a href="https://plus.google.com/116576795878625530902" target="_blank"><i class="icon-google-plus"></i></a>
                
            </div>
        </div>
    </div>
    <div class="contain fn-clear">
        <div class="container fn-clear">
            <div class="main">
                <div class="article article-post">
    <h2 class="title">代码发布流程的一些探讨</h2>
    <div class="info">
        <span class="info-title"><i class="icon-calendar"></i> Published: </span>
        <span class="info-date">24 Jan 2014</span>
        <span class="info-title"><i class="icon-folder-open"></i> Category: </span>
        <span class="info-link"><a href="http://hankewins.com/categories.html#-ref" ></a></span>
    </div>
    <p>今天组织了一次<a href="http://hankewins.com/reveal.html">代码发布流程研讨会</a>，指在讨论现有代码发布流程的一些优缺点，通过收集同学们已知的代码发布流程，进行总结并优化现有的代码发布流程。</p>

<h2>目前我们代码发布流程是怎么样的？</h2>

<ul>
<li>开发完成、测试完成</li>
<li>前端打包静态文件包</li>
<li>后端打包后台文件包（同时修改后台版本号）</li>
<li>后台开发汇总前后端文件包</li>
<li>邮件运维及相关人员</li>
<li>运维整理后，开始更新</li>
<li>先更新静态文件包</li>
<li>再更新后台文件包</li>
<li>最后更新前台文件包</li>
<li>中间任一流程出问题，重新更新</li>
<li>如更新问题来源于程序，则回滚</li>
</ul>

<p>优点：代码发布完成有运维人员控制，对代码安全以及线上正常运营起到了一定的保障作用。<br>
缺点：人工手动操作过多、发布流程时间过长、更新依赖性过高、解决线上问题响应过慢。</p>

<p>通过目前代码发布流程的缺点，我们可以看到由于人工手动操作过多，直接导致程序包不完整的概率，从源头就增加了线上环境不稳定因素，从而引起恶性循环。
另一方面由于采用CDN技术，静态文件分离，如需更新静态文件必须走发布流程（静态文件更新很频繁），直接导致更新时间过长，对线上问题的响应过慢。</p>

<h2>IT、通信等企业的发布流程？</h2>

<ul>
<li>电商企业（阿里、淘宝、麦包包）</li>
<li>传统通信（中兴、华为）</li>
<li>IT互联网（百度、腾讯、网易）</li>
<li>中小企业、小团队</li>
</ul>

<p>电商企业：根据安全等级分为主业务、子业务。</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">主业务——开发完成、测试完成 -&gt; 代码审查 -&gt; 安全审查 -&gt; 技术VP审批 -&gt; 运维团队（灰度发布） -&gt; 运维团队(发布)
子业务——开发完成、测试完成 -&gt; 代码审查 -&gt; 发布平台
</code></pre></div>
<p>传统通信：根据业务范围分为通信业务、互联网业务</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">通信业务——开发完成、测试完成 -&gt; 各应用团队提审　-&gt; 联合审查 -&gt; 测试、调试 -&gt; 生产流程
互联网业务——开发完成、测试完成 -&gt; 运维团队（预发布）-&gt; 测试通过 -&gt; 技术VP审批 -&gt; 运维团队（发布）
</code></pre></div>
<p>IT互联网：  根据业务等级分为主业务、子业务。</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">主业务——开发完成、测试完成 -&gt; 代码审查 -&gt; 安全审查 -&gt; 技术VP审批 -&gt; 运维团队（灰度发布） -&gt; 运维团队(发布)
子业务——开发完成、测试完成 -&gt; 发布平台(开发可直接操作)
</code></pre></div>
<p>中小企业、小团队：根据需求发布</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">发布流程(1)：开发完成（自测完成）-&gt; 开发上传代码到服务器
发布流程(2)：开发完成（自测完成）-&gt; 开发上传DWZ包、或者其他文件包 -&gt; 运维人员（手动发布）
</code></pre></div>
<p>以上只是根据内部小伙伴的工作情况，初步的进行总结各企业的发布流程，与实际发布流程可能有较大的出入。（实际发布流程受公司技术管理、公司服务器架构、
公司规模、公司业务方向、公司战略等各因素的影响）</p>

<p>根据我们的需求及现有环境，我们缺少灰度发布（预发布）和发布平台，目的是减少手动操作以及提高应对线上业务的响应能力。</p>

<p>本文章只是粗略的介绍了发布流程，如需了解详细的发布流程，可以给我留言，谢谢！</p>

<p>最后，如果你有好的发布流程优化方案，希望你能给我们一些帮助！</p>

    <nav class="article-previous fn-clear">
        
        <a class="prev" href="/2014/01/22/wordpress-blog-to-github-pages.html" rel="bookmark">&laquo;&nbsp;从 wordpress 搬迁到 github pages...</a>
        
        
        <a class="next" href="/2014/01/26/gionee-group-annual-party.html" rel="bookmark">2014年新金立新征程&nbsp;&raquo;</a>
        
    </nav>
    <div class="comment">
        
            
            <div class="ds-thread"></div>
            
        
    </div>
</div>

            </div>
            <div class="aside">
                <div class="aside-contact">
                    <h4 class="title">About me</h4>
                    <div class="det fn-clear">
                        <div class="det-image">
                            <img src="https://2.gravatar.com/avatar/aa1d198825148763d77cc8de072fee63" />
                        </div>
                        <div class="det-text">
                            <p>我是「Hankewins」,金立移动互联中心前端开发工程师！</p>
                        </div>
                    </div>
                </div>

                <div class="aside-item">
                    <h4 class="title">Recent Posts</h4>
                    <ul class="list">
                        
                            <li><a href="http://hankewins.com/2014/02/18/how-to-development-a-navtive-app-for-html5.html" title="解决HTML5移动开发中边框显示2px" rel="bookmark">解决HTML5移动开发中边框显示2px</a></li>
                        
                            <li><a href="http://hankewins.com/2014/01/26/gionee-group-annual-party.html" title="2014年新金立新征程" rel="bookmark">2014年新金立新征程</a></li>
                        
                            <li><a href="http://hankewins.com/2014/01/24/how-to-release-your-code-to-online.html" title="代码发布流程的一些探讨" rel="bookmark">代码发布流程的一些探讨</a></li>
                        
                            <li><a href="http://hankewins.com/2014/01/22/wordpress-blog-to-github-pages.html" title="从 wordpress 搬迁到 github pages" rel="bookmark">从 wordpress 搬迁到 github pages</a></li>
                        
                            <li><a href="http://hankewins.com/2014/01/18/third-product-center-annual-party.html" title="金立移动互联网第三产品中心年度盛会" rel="bookmark">金立移动互联网第三产品中心年度盛会</a></li>
                        
                            <li><a href="http://hankewins.com/2013/12/28/2013-year.html" title="2013年终总结" rel="bookmark">2013年终总结</a></li>
                        
                    </ul>
                </div>

                <div class="aside-item">
                    <h4 class="title">Links</h4>
                    <ul class="list">
                        
                            
                                
                                <li><a href="http://bh-lay.com/" title="小剧客栈" target="_blank">小剧客栈</a></li>
                                
                                <li><a href="http://12mo.com/" title="12mo" target="_blank">12mo</a></li>
                                
                                <li><a href="http://vkdemo.sinaapp.com/" title="valleykid" target="_blank">valleykid</a></li>
                                
                                <li><a href="http://zhanxin.info/" title="展新「掌心」" target="_blank">展新「掌心」</a></li>
                                
                            
                        
                            
                        
                            
                        
                    </ul>
                </div>

            </div>
        </div>
    </div>
    <div class="foot">
        <div class="footer">
            <p>© 2013 - <script>document.write((new Date).getFullYear());</script> Hankewins. Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a> and host by <a href="http://github.com/hankewins">github</a>, Design by <a href="http://www.zhanxin.info" target="_blank">zhanxin.info</a>.</p>
        </div>
    </div>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    
        
            
            <script type="text/javascript">
                var duoshuoQuery = {short_name:"hankewins"};
                (function() {
                    var ds = document.createElement('script');
                    ds.type = 'text/javascript';ds.async = true;
                    ds.src = 'http://static.duoshuo.com/embed.js';
                    ds.charset = 'UTF-8';
                    (document.getElementsByTagName('head')[0]
                    || document.getElementsByTagName('body')[0]).appendChild(ds);
                })();
            </script>
            
        
    
<!-- 百度统计 -->
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fb494e42315911585e7eddac10ea895ff' type='text/javascript'%3E%3C/script%3E"));
</script>
</body>
</html>
